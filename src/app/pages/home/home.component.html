<div class="home-container">
  <h2>{{ user?.displayName }}</h2>
  <!-- UI card to show total events, number of confirmed events, number of not converted/confirmed events, conversion percentage -->
  <mat-card class="counts-card">
    <mat-card-content>
      <div class="counts">
        <span>Total Events</span>
        <span>{{ dashboardStats.total }}</span>
      </div>

      <div class="counts">
        <span>Completed</span>
        <span>{{ dashboardStats.completed }}</span>
      </div>

      <div class="counts">
        <span>Upcoming</span>
        <span>{{ dashboardStats.upcoming }}</span>
      </div>

      <!-- <div class="counts">
        <span>Conversion</span>
        <span>{{ dashboardStats.conversion }}%</span>
      </div> -->
    </mat-card-content>
  </mat-card>

  <mat-card *ngIf="!loading" class="demo-inline-calendar-card">
    <!-- <mat-calendar [dateClass]="dateClass"></mat-calendar> -->
  </mat-card>
  @if (loading) {
  <div class="spinner-container">
    <mat-progress-spinner
      class="example-margin"
      mode="indeterminate"
      diameter="32"
    >
    </mat-progress-spinner>
  </div>

  } @else {
  <div *ngIf="!loading && groupedEvents.length === 0">No events found.</div>

  <div class="list-container" *ngFor="let group of groupedEvents">
    <h4 class="month">{{ group.month }}</h4>

    <mat-card
      class="row"
      *ngFor="let item of group.events"
      (click)="openEventDetails(item)"
      [ngClass]="{
        lead: !item.event_info.confirmed,
        completed: item.event_info.function_date < nowISO
      }"
    >
      <span class="date">
        {{ item.event_info.function_date | date : "dd" }}
      </span>

      <span>{{ item.event_info.client_name }}</span>
      <span>{{ item.event_info.venue }}</span>
      <span>{{ item.event_info.location || "" }}</span>
    </mat-card>
  </div>
  }

  <div class="load-more-container" *ngIf="hasMore && !loading">
    <button mat-stroked-button color="primary" (click)="loadMoreEvents()">
      Load More
    </button>
  </div>

  <div *ngIf="loading" class="spinner-container">
    <mat-progress-spinner
      mode="indeterminate"
      diameter="32"
    ></mat-progress-spinner>
  </div>

  <!-- Create Event -->
  <button mat-fab color="primary" class="fab" (click)="openEventDetails()">
    <mat-icon>add</mat-icon>
  </button>
</div>
